<!DOCTYPE html>
<html style="height: 100%;">

<head>
    <title>ONLYOFFICE Api Documentation</title>
</head>

<body style="height: 100%; margin: 0;">
    <button onclick="javascript:getAllComments();" style="height:100px; width:100px;">comment</button>
    <button onclick="javascript:addHello();" style="height:100px; width:100px;">hello</button>
    <button onclick="javascript:addBlockLvlSdt();" style="height:100px; width:100px;">BlockLvlSdt</button>
    <button onclick="javascript:addInlineLvlSdt();" style="height:100px; width:100px;">InlineLvlSdt</button>
    <button onclick="javascript:attachOnChangeContentControl();" style="height:100px; width:100px;">onChangeCC</button>
    <button onclick="javascript:getAllContentControls();" style="height:100px; width:100px;">get all CC</button>

    <div id="placeholder" style="height: 500px"></div>
    <script type="text/javascript" src="http://192.168.0.104:1000/web-apps/apps/api/documents/api.js"></script>

    <script type="text/javascript">

        var uniqueId = Date.now().toString(36) + Math.random().toString(36).substring(2);


        window.docEditor = new DocsAPI.DocEditor("placeholder",
            {
                "document": {
                    "fileType": "docx",
                    "key": uniqueId.toString(),
                    "title": "test.docx",
                    "url": "http://192.168.0.104:8080/files/empty.docx"
                },
                "documentType": "word",
                "editorConfig": {
                    "callbackUrl": "http://192.168.0.104:83/editors/callback",
                },
                "height": "500px",
                "width": "100%",
                events: {
                    onDocumentReady: () => { window.connector = docEditor.createConnector(); }
                }
            });

        function getAllComments() {
            console.log('GetAllComments')
            connector.executeMethod("GetAllComments", [], (callback_arg) => { console.log(callback_arg) });
        };

        function addHello() {
            connector.callCommand(function () {
                var oDocument = Api.GetDocument();
                var oParagraph = Api.CreateParagraph();
                oParagraph.AddText("Hello");
                oDocument.InsertContent([oParagraph]);
                Api.AddComment(oParagraph, "text", "author")
            },
                (callback_arg) => { console.log('test:', callback_arg) }
            );
        };

        function addBlockLvlSdt() {

            // console.log(uniqueId)

            let config = {
                type: 1,
                property: {
                    "Appearance": 1,
                    "Id": uniqueId,
                    "Lock": 3,
                    "Tag": "{TAG}"
                }
            }

            connector.executeMethod("AddContentControl", [config.type, config.property], (callback_arg) => {
                console.log(callback_arg);
            });
        }

        function addInlineLvlSdt() {

            let config = {
                type: 2,
                property: {
                    "Appearance": 1,
                    "Id": uniqueId,
                    "Lock": 3,
                    "Tag": "{TAG}"
                }
            }

            connector.executeMethod("AddContentControl", [config.type, config.property], (callback_arg) => {
                console.log(callback_arg);
            });
        }

        function attachOnChangeContentControl() {
            connector.attachEvent("onChangeContentControl", function () {
                console.log("event: onChangeContentControl");
            });
        };

        function getAllContentControls() {
            connector.executeMethod("GetAllContentControls", [], (callback_arg) => {
                if (typeof callback_arg[0] != "undefined") {
                    // console.log(callback_arg[0].Tag);
                    for (var i = 0; i < callback_arg.length; i++) {
                        // console.log(i)
                        console.log(callback_arg[i].Tag);
                    }
                }
            });
        };

    </script>
</body>

</html>