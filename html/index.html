<!DOCTYPE html>
<html style="height: 100%">

<head>
  <title>DocsAPI</title>
  <script type="text/javascript" src="http://192.168.0.153:3000/web-apps/apps/api/documents/api.js"></script>
  <script type="text/javascript" src="code.js"></script>
</head>

<body style="height: 100%; margin: 0">
  <button onclick="javascript:getAllComments();" style="height: 50px; width: 100px">
    comment
  </button>
  <button onclick="javascript:addHello();" style="height: 50px; width: 100px">
    hello
  </button>
  <button onclick="javascript:addBlockLvlSdt();" style="height: 50px; width: 100px">
    BlockLvlSdt
  </button>
  <button onclick="javascript:addInlineLvlSdt();" style="height: 50px; width: 100px">
    InlineLvlSdt
  </button>
  <button onclick="javascript:attachOnChangeContentControl();" style="height: 50px; width: 100px">
    onChangeCC
  </button>
  <button onclick="javascript:getAllContentControls();" style="height: 50px; width: 100px">
    get all CC
  </button>
  <button onclick="javascript:insertAndReplaceProps();" style="height: 50px; width: 100px">
    Raplace
  </button>
  <button onclick="javascript:GetRewiewReport();" style="height: 50px; width: 100px">
    GetRewiewReport
  </button>
  <button onclick="javascript:pullMetaChange()" style="height: 50px; width: 100px;">
    Pull meta
  </button>
  <!-- <button onclick="javascript:TrackRevisionON();" style="height:50px; width:100px;">TrackRevisionON</button>
    <button onclick="javascript:TrackRevisionOFF();" style="height:50px; width:100px;">TrackRevisionOFF</button> -->

  <div id="placeholder" style="height: 500px"></div>

  <script>
    var uniqueId =
      Date.now().toString(36) + Math.random().toString(36).substring(2);

    var ip = "192.168.0.153";
    var callbackurl = '' // 'https://a54124be-9d23-4b1d-b43d-de66863b94f5.mock.pstmn.io' // 'https://eowzrjdoaq8tuyh.m.pipedream.net';
    // var file = "empty.docx";
    var file = "empty.docx";
    var url = `http://${ip}:7080/files/${file}`;
    // var url = 'https://testing-documentserver-files.s3.amazonaws.com/public_documents/empty.docx'

    console.log(uniqueId)
    console.log(`file url: ${url}`);

    var _type = "desktop";
    var _height = "90%"; //bug
    var _width = "100%";

    function createConnector() {
      window.connector = docEditor.createConnector();
    }

    window.docEditor = new DocsAPI.DocEditor("placeholder", {
      type: _type,
      document: {
        fileType: "docx",
        info: {
          owner: "John Smith",
          favorite: true,
          folder: "Example Files",
          sharingSettings: [
            {
              permissions: "Full Access",
              user: "John Smith",
            },
            {
              isLink: true,
              permissions: "Read Only",
              user: "External link",
            },
          ],
        },
        key: uniqueId.toString(),
        title: "empty.docx",
        url: url,
      },
      documentType: "word",
      editorConfig: {
        customization: {
          zoom: 120,
          integrationMode: "embed",
        },
        "callbackUrl": callbackurl,
      },
      height: _height,
      width: _width,
      events: {
        "onDocumentReady": createConnector,
        "onMetaChange": onMetaChange,
      },
    });
  </script>
</body>
</html>
